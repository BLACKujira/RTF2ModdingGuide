# FModelを使ってゲームアセットを閲覧・抽出する

*FModel* は強力な *UE4/5* アセットビューアー兼アンパッカーです。個人的には、Mod開発における重要性は *UE4SS* に次ぐものだと思います。*R-Type Final 2* の場合、正しくアンパックするためには *AESキー* と *.usmap マッピングファイル* の両方が必要です。

## ディレクトリの選択

1. *FModel* を開き、上部メニューの `Settings` をクリックします。
2. 次の2項目を設定します：
   - `Archive Directory`：ゲームディレクトリ内の `RTypeFinal2` フォルダを指定します。  
     （例：`D:\Program Files (x86)\Steam\steamapps\common\R-Type Final 2\RTypeFinal2`）
   - `UE_Versions`：`GAME_UE4_26` を選択
3. `OK` をクリックして変更を保存します。

正しく設定されると、左側にゲームの `.pak` ファイルが表示されます。ただし、この時点ではファイルはグレー表示で、まだ復号されておらず、アンパックできません。

現在のバージョンでは、*FModel* のメニュー `Directory -> Selector` に自動検出・自動設定の機能もあるようです。試してみる価値はあります。

## AESキーの読み込み

1. 上部メニューの `Directory -> AES` を開きます。
2. *AESKeyFinder* で抽出した複数のAESキーを一つずつ試します。
3. 正しいキーが入力されると、左側の `.pak` ファイル名がグレーから白に変わり、復号に成功したことを示します。

この時点で、基本的な内容のアンパックが可能になります。`Loading Mode` を `ALL` に設定し、`Load` をクリックしてから `Folders` タブに切り替えると、ゲームのリソースとディレクトリ構成が表示されます。ただし、まだプレビューやエクスポートを行うとエラーが発生します。

## `.usmap` マッピングファイルの読み込み

1. メニューの `Settings` をクリックします。
2. `ADVANCED` セクション内の `Local Mapping File` にチェックを入れます。
3. `Mapping File Path` に、先ほど抽出した `.usmap` ファイルのパスを設定します。

これで、リソースのプレビューと抽出が正常に行えるようになります。
